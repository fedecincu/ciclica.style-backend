<h2 class="mb-4">Editar producto</h2>

<form action="/admin/administrador/catalogo/editar" method="post" enctype="multipart/form-data">
  <input type="hidden" name="id" value="{{producto.id}}">

  {{#if producto.imagen}}
  <div class="mb-3">
    <label class="form-label">Imagen actual</label>
    <div>
      <img src="{{producto.imagen}}" alt="{{producto.nombre}}" style="max-width:150px; max-height:150px; object-fit:cover;" />
    </div>
  </div>
  {{/if}}

  <div class="mb-3">
    <label for="imagen" class="form-label">Cambiar imagen (opcional)</label>
    <input type="file" class="form-control" id="imagen" name="imagen">
  </div>

  {{#if producto.imagen}}
  <div class="mb-3">
    <div class="form-check">
      <input class="form-check-input" type="checkbox" name="img_delete" id="img_delete" value="1">
      <label class="form-check-label" for="img_delete">
        Eliminar imagen actual
      </label>
    </div>
  </div>
  {{/if}}

  <div class="mb-3">
    <label for="nombre" class="form-label">Nombre</label>
    <input type="text" class="form-control" id="nombre" name="nombre" value="{{producto.nombre}}" required>
  </div>

  <div class="mb-3">
    <label for="descripcion" class="form-label">Descripción</label>
    <textarea class="form-control" id="descripcion" name="descripcion" required>{{producto.descripcion}}</textarea>
  </div>

  <div class="mb-3">
    <label for="precio" class="form-label">Precio</label>
    <input type="number" step="0.01" class="form-control" id="precio" name="precio" value="{{producto.precio}}" required>
  </div>

  <div class="mb-3">
    <label for="categoria" class="form-label">Categoría</label>
    <select class="form-select" id="categoria" name="categoria">
      <option value="">Seleccionar categoría</option>
      <option value="Accesorios">Accesorios</option>
      <option value="Bolsos">Bolsos</option>
      <option value="Ropa">Ropa</option>
    </select>
  </div>

  <button type="submit" class="btn btn-primary">Guardar cambios</button>
  <a href="/admin/administrador/catalogo" class="btn btn-secondary">Cancelar</a>
  
  {{#if error}}
  <div class="alert alert-danger mt-3">{{message}}</div>
  {{/if}}
</form>

<script>
  (function(){
    try {
      var sel = document.getElementById('categoria');
      var val = '{{producto.categoria}}';
      if (sel && val) sel.value = val;
    } catch(e) { console.log(e); }
  })();
</script>
